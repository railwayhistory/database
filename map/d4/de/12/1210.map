# DE 1210.  Elmshorn (ausschl.) - Niebüll (einschl.)
#
let niesud = path("path.de.1201");
let niewes = path("path.de.1200");
let elmnie = path("path.de.1210");

with detail = [4, 5] {
    # ...

    #--- point.de.Niebüll
    #

    # Gl. 1.
    track(:station :open,
            elmnie[:nie.ns - 3.0dl, :nie] << 1.5dt
        --  elmnie[:nie, :nie.nf + 1.0dl] << 1.5dt
        --  elmnie[:nie.nf + 2.0dl, :nie.nf + 2.1dl] << 0.5dt
    );

    # Gl. 2. Richtung Westerland
    track(:first :station :open, elmnie[:nie.a, :nie.f] << 0.5dt);

    # Gl. 3.
    track(:first :station :open,
            elmnie[:nie.a, :nie.nf + 2.0dl] >> 0.5dt
        --  elmnie[:nie.nf + 3.0dl, :nie.nf + 3.1dl] << 0.5dt
    );

    # Gl. 4.
    track(:first :station :open,
            elmnie[:nie.ns - 1.1dl, :nie.ns - 1.0dl] >> 0.5dt
        --  elmnie[:nie.ns        , :nie.nf + 7.0dl] >> 1.5dt
        ..  niesud[:nie.f + 3dl, :nie.ff        ] << 0.5dt
    );

    # Gl. 5.
    track(:station :open,
            elmnie[:nie.a,          :nie.r  + 4.0dl] >> 1.5dt
        ..  elmnie[:nie.ns - 2.0dl, :nie.nf + 1.0dl] >> 2.5dt
    );

    # Gl. 6
    track(:station :open,
            elmnie[:nie.r  + 1.9dl, :nie.r  + 2.0dl] >> 1.5dt
        --  elmnie[:nie.r  + 3.0dl, :nie.r  + 4.0dl] >> 2.5dt
        ..  elmnie[:nie.ns + 2.0dl, :nie.nf        ] >> 3.5dt
    );

    # Gl. 7
    track(:station :open,
            elmnie[:nie.r  - 0.1dl, :nie.r         ] >> 1.5dt
        --  elmnie[:nie.r  + 4.0dl, :nie.r  + 4.1dl] >> 4.5dt
        ..  elmnie[:nie.ns + 2.0dl, :nie.nf - 2.0dl] >> 5.5dt
        --  elmnie[:nie.nf + 2.0dl, :nie.nf + 2.1dl] >> 1.5dt
    );

    # Gl. 11 - 18
    track(:station :open,
            elmnie[:nie.ns - 0.1dl, :nie.ns] << 2.5dt
        --  elmnie[:nie.ns + 2.0dl, :nie - 0.6sw] << 4.5dt
    );
    track(:station :open, elmnie[:nie.ns + 1.0dl, :nie - 0.6sw] << 3.5dt);

    # Gl. (21 -) 10.
    track(:station :removed, elmnie[:nie.a, :nie.r] << 1.5dt);
    track(:station :open,
            elmnie[:nie.r, :nie.r + 1.0dl] << 1.5dt
        ..  elmnie[:nie.ns - 3.0dl, :nie - 0.6sw] << 2.5dt
    );

    # Gl. 22
    track(:station :open,
            elmnie[:nie.nf + 5.9dl, :nie.nf + 6.0dl] >> 1.5dt
        --  elmnie[:nie.nf + 7.0dl, :nie.nf + 7.1dl] >> 2.5dt
        ..  niesud[:nie.f  + 3.0dl, :nie.ff] >> 0.5dt
    );

    # Gl. 23
    track(:station :open,
            elmnie[:nie.nf + 3.9dl, :nie.nf + 4.0dl] >> 1.5dt
        --  elmnie[:nie.nf + 6.0dl, :nie.nf + 7.0dl] >> 3.5dt
        ..  niesud[:nie.f + 3dl, :nie.f + 3.1dl] >> 1.5dt
    );

    # Gleisverbindungen Südkopf
    # W2 - W3
    track(:station :open,
            elmnie[:nie.r  + 0.9dl, :nie.r  + 1.0dl] >> 1.5dt
        --  elmnie[:nie.r  + 2.0dl, :nie.f  + 2.1dl] >> 0.5dt
    );
    # W5 - W6
    track(:station :open,
            elmnie[:nie.ns - 6.1dl, :nie.ns - 6.0dl] >> 0.5dt
        --  elmnie[:nie.ns - 5.0dl, :nie.ns - 4.9dl] << 0.5dt
    );
    # W7 - W13 - W9
    track(:station :open,
            elmnie[:nie.ns - 4.1dl, :nie.ns - 4.0dl] << 0.5dt
        --  elmnie[:nie.ns - 2.0dl, :nie.ns - 1.9dl] << 2.5dt
    );
    # W8 - W11
    track(:station :open,
            elmnie[:nie.ns - 3.1dl, :nie.ns - 3.0dl] << 0.5dt
        --  elmnie[:nie.ns - 2.0dl, :nie.ns - 1.9dl] >> 0.5dt
    );

    # Gleisverbindungen Nordkopf
    # W53 - W71 - W61
    track(:station :open,
            elmnie[:nie.nf + 2.9dl, :nie.nf + 3.0dl] >> 1.5dt
        --  elmnie[:nie.nf + 4.0dl, :nie.nf + 5.0dl] >> 0.5dt
        --  elmnie[:nie.nf + 6.0dl, :nie.nf + 6.1dl] << 0.5dt
    );
    # W56 - W55
    track(:station :open,
            elmnie[:nie.nf + 3.9dl, :nie.nf + 4.0dl] << 0.5dt
        --  elmnie[:nie.nf + 5.0dl, :nie.nf + 5.1dl] << 1.5dt
    );

    # Bw Autozug
    track(:station :open,
            elmnie[:nie.nf + 5.0dl, :nie.nf + 5.1dl] >> 0.5dt
        ..  niesud[:nie.f + 5.0dl - 0.5sw, :nie.f + 5.1dl - 0.3sw] << 2dt
    );
    marker(:de.bw :open :left, niesud[:nie.f + 5dl] << 1dt);

    marker(:de.bf :open :left, elmnie[:nie] << 1.5dt);
    with layer = -1 station(:right :left_align :open,
        elmnie[:nie - 0.4sw] >> 6.5dt,
        span(:medium :bold, "Niebüll"),
        hbox(:left :top,
            span(:xsmall, "  "),
            vbox(:right :top,
                span(:xsmall, "1200: "),
                span(:xsmall, "1201: "),
                span(:xsmall, "1210: ")
            ),
            vbox(:right :top,
                span(:xsmall, "198,"),
                span(:xsmall, "162,"),
                span(:xsmall, "198,")
            ),
            vbox(:left :top,
                span(:xsmall, "45"),
                span(:xsmall, "00"),
                span(:xsmall, "45,")
            ),
            vbox(:left :top,
                span(:xsmall :closed, " (0,00)"),
                span(:xsmall, ""),
                span(:xsmall :closed, " (162,02")
            )
        )
    );

    # Kleinbahnhof
    track(:third :station :open,
            elmnie[:nie - 1sw, :nie] << 5.5dt
    );
    track(:station :open,
            elmnie[:nie, :nie.nf] << 5.5dt
        --  elmnie[:nie.nf + 4.0dl, :nie.f] << 1.5dt
    );
    marker(:de.bf :open :left, elmnie[:nie] << 5.5dt);
    station(:left :open, elmnie[:nie - 0.6sw] << 5.5dt << 1.3sh,
        vbox(:center :bottom,
            span(:medium :bold :gone, "Niebüll Kleinb"),
            span(:medium :bold :gone, "Niebüll NVAG"),
            span(:medium :bold, "Niebüll neg")
        ),
        "9100: ??"
    );
}

