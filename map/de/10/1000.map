# DE 1000.  Flensburg Weiche (ausschl) - Harrislee Grenze
#
let flwhag = path("path.de.1000");
let neufle = path("path.de.1040");

with detail = 1 {
    track(:first, neufle[:flw, :apad] .. flwhag[:fri, :f]);
}

with detail = 2 {
    track(:first, neufle[:flw, :apad] .. flwhag[:fri, :f]);
}

with detail = 3 {
    #--- Flensburg Weiche
    # 
    track(:first :station,
            neufle[:fws - 2.1dl, :fws - 2dl] << 0.5dt
        --  neufle[:fws, :fws + .1dl] << 2.5dt
    );
    track(:first :station, neufle[:fws - 1dl, :fws] << 1.5dt);
    track(:double :first :station,
            neufle[:fws, :flw.wr2] << 2dt
        ..  neufle[:flin, :apad] << 3dt
    );

    #--- Flensburg Weiche (ausschl) - Harrislee Grenze
    # 
    track(:double :first :cat,
            neufle[:apad, :apad + .1dl] << 3dt
        ..  flwhag[:fri - .5sw, :f]
    );

    marker(:de.abzw, flwhag[:fri] >> 1.5dt);

    with layer = -1 marker(:de.bf :removed, flwhag[:har] >> .5dt);
    slabel(:left :removed, flwhag[:har - .5ssw] << 2dt, "Harrislee");

    marker(:de.dirgr, flwhag[:hag] >> 0.5dt);
    marker(:statdt, flwhag[:hag] << 0.5dt);
    marker(:de.dirgr :left, flwhag[:hag] << 0.5dt);
    label(
        flwhag[:hag] << 5dt,
        hbox(
            :right :middle,
            vbox(:center :middle,
                span(:small, "DK"),
                hbar(0.3),
                span(:small, "DE")
            )
        )
    );
}

with detail = 4 {
    track(:double :first :cat, flwhag[:ffle, :fri - 1sw]);

    # Friedensweg
    track(:first, flwhag[:fri - 1sw, :fri + 1sw] << 0.5dt);
    track(:first,
           flwhag[:fri - 1sw, :fri - .2sw - 1dl] >> 0.5dt
        -- flwhag[:fri - .2sw, :fri - 0.1sw] >> 1.5dt
    );
    track(:first,
           flwhag[:fri - 1sw, :fri + .2sw + 2dl] >> 1.5dt
        -- flwhag[:fri + .2sw + 3dl, :fri + 1sw] >> 0.5dt
    );
    track(:station,
           flwhag[:fri + .1sw, :fri + .2sw] >> 1.5dt
        -- flwhag[:fri + .2sw + 2dl, :fri + .2sw + 3dl] << 0.5dt
    );
    marker(:de.abzw, flwhag[:fri] >> 1.5dt);
    station(
        :left, flwhag[:fri - .4sw] << .5dt << 6bp,
        "F. Friedensweg",
        hbox(:right :top,
            vbox(:left :top,
                span(:small, "1000: "),
                span(:small, "1005: ")
            ),
            vbox(:right :top,
                span(:small, "174,57"),
                span(:small, "5,49")
            )
        )
    );


    track(:double :first :cat, flwhag[:fri + 1sw, :har - .6sw]);
    with layer = 1 line_badge(:open, flwhag[:har - 1.5km], "1000");


    # Harrislee
    with layer = 0.5 track(:double :first, flwhag[:har - 0.6sw, :har.x + 4dl]);
    track(:station :removed,
           flwhag[:har - 0.51sw, :har - 0.5sw] << 0.5dt
        -- flwhag[:har - 0.5sw + 1dl, :har.x - 1dl] << 1.5dt
        -- flwhag[:har.x + 4dl, :har.f] >> 3.5dt
    );
    track(:station :removed,
           flwhag[:har.x + 3dl, :har.f] >> 2.5dt
    );
    marker(:de.bf :removed, flwhag[:har] >> 0.5dt);
    station(
        :right :removed, flwhag[:har - .4sw] >> 1.3sw,
        "Harrislee", "177,44"
    );


    track(:double :first :cat, flwhag[:har.x + 4dl, :f]);

    # Harrislee Grenze
    marker(:de.dirgr, flwhag[:hag] >> 0.5dt);
    marker(:statdt, flwhag[:hag] << 0.5dt);
    marker(:de.dirgr :left, flwhag[:hag] << 0.5dt);
    label(
        flwhag[:hag] << 5dt,
        hbox(
            :right :middle,
            vbox(:center :middle,
                span(:small, "DK 26: 110,6"),
                hbar(0.3),
                span(:small, "DE 1000: 179,784")
            )
        )
    );
}

