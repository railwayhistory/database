# DE 1042.  Neumünster (ausschl.) - Heide (Holst) (ausschl.)
#
let altkie = path("path.de.1220");
let neuhei = path("path.de.1042");


with detail = [4, 5] {
    # Streckengleis Neumünster - Wasbek
    track(:second :open, neuhei[:aa, :was - 1sw]);
    with layer = 1 line_badge(:open, neuhei[:was - 2.1km], "1042");


    #--- point.de.Neumünster-Stadtwald
    #
    marker(:de.hp :open :left, neuhei[:nst]);
    station(:bottom, neuhei[:nst] << 1.4sh,
        "N. Stadtwald", "2,03"
    );


    #--- point.de.Wasbek
    #
    track(:second :station :open, neuhei[:was - 1sw, :was + 1sw]);
    marker(:de.hp :open :left, neuhei[:was]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:was]);
    station(:bottom, neuhei[:was] << 1.4sh,
        "Wasbek", "6,38"
    );

    # Streckengleis Wasbek - Aukrug
    track(:second :open, neuhei[:was + 1sw, :auk - 1sw]);


    #--- point.de.Bünzenfeld
    #
    marker(:de.ldst :removed :left, neuhei[:bun]);
    station(:bottom :removed, neuhei[:bun] << 1.2sh,
        "Bünzenfeld", "10,40"
    );


    #--- point.de.Aukrug
    #
    track(:second :station :open, neuhei[:auk - 1sw, :auk + 1sw]);
    marker(:de.hp :open :right, neuhei[:auk]);
    with layer = -1 marker(:de.bf :gone :right, neuhei[:auk]);
    station(:top :open, neuhei[:auk] >> 1.4sh,
        vbox(:center :bottom,
            span(:medium :closed, "Innien"),
            span(:medium, "Aukrug")
        ),
        "13,83"
    );

    # Streckengleis Aukrug - Hohenwestedt
    track(:second :open, neuhei[:auk + 1sw, :hwe.a]);
    with layer = 1 line_badge(:open, neuhei[:hwe - 4.8km], "1042");


    #--- point.de.Hohenwestedt
    track(:second :station :open, neuhei[:hwe.a, :hwe.f]);
    track(:station :open,
            neuhei[:hwe.a + 0.9dl, :hwe.a + 1dl]
        --  neuhei[:hwe.a + 2dl, :hwe.f] << 1dt
    );
    track(:station :open,
            neuhei[:hwe.f - 3.1dl, :hwe.f - 3dl] << 1dt
        --  neuhei[:hwe.f - 2dl, :hwe.f - 1.9dl]
    );
    marker(:de.bf :open :right, neuhei[:hwe]);
    station(:top :open, neuhei[:hwe] >> 1.4sh,
        span(:medium :bold, "Hohenwestedt"),
        "1042: 22,73"
    );

    # Streckengleis Hohenwestedt - Osterstedt
    track(:second :open, neuhei[:hwe.f, :ost - 1sw]);
    with layer = 1 line_badge(:open, neuhei[:hwe + 3.0km], "1042");


    #--- point.de.Osterstedt
    #
    track(:second :station :open, neuhei[:ost - 1sw, :ost + 1sw]);
    marker(:de.hp :open :right, neuhei[:ost]);
    with layer = -1 marker(:de.bf :gone :right, neuhei[:ost]);
    station(:top :open, neuhei[:ost] >> 1.4sh,
        "Osterstedt", "28,17"
    );

    # Streckengleis Osterstedt - Beringstedt
    track(:second :open, neuhei[:ost + 1sw, :ber - 1sw]);


    #--- point.de.Beringstedt
    #
    track(:second :station :open, neuhei[:ber - 1sw, :ber + 1sw]);
    marker(:de.hp :open :left, neuhei[:ber]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:ber]);
    station(:top :open, neuhei[:ber] >> 1dt,
        "Beringstedt", "30,90"
    );

    # Streckengleis Beringstedt - Gokels
    track(:second :open, neuhei[:ber + 1sw, :gok - 1sw]);


    #--- point.de.Gokels
    #
    track(:second :station :open, neuhei[:gok - 1sw, :gok + 1sw]);
    marker(:de.hp :open :left, neuhei[:gok]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:gok]);
    station(:bottom :open, neuhei[:gok] << 1.4sh,
        "Gokels", "35,63"
    );

    # Streckengleis Gokels - Hademarschen
    track(:second :open, neuhei[:gok + 1sw, :had - 1sw]);


    #--- point.de.Hademarschen
    #
    track(:second :station :open, neuhei[:had - 1sw, :had + 1sw]);
    marker(:de.hp :open :right, neuhei[:had]);
    with layer = -1 marker(:de.bf :gone :right, neuhei[:had]);
    station(:top :open, neuhei[:had] >> 1.4sh,
        "Hademarschen", "39,19"
    );

    # Streckengleis Hademarschen - Beldorf
    track(:second :open, neuhei[:had + 1sw, :bel - 1sw]);


    #--- point.de.Beldorf
    #
    track(:second :station :open, neuhei[:bel - 1sw, :bel + 1sw]);
    marker(:de.hp :open :left, neuhei[:bel]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:bel]);
    station(:bottom :open, neuhei[:bel] << 1.4sh,
        "Beldorf", "43,10"
    );

    # Streckengleis Beldorf - Albersdorf
    track(:second :open, neuhei[:bel + 1sw, :alb - 1sw]);


    #--- point.de.Beldorf-Dkst
    #
    marker(:de.dkst :closed :right, neuhei[:bed]);
    slabel(:top, neuhei[:bed] >> 1.4sh,
        span(:xsmall :closed, "44,91")
    );


    #--- point.de.Albersdorf
    #
    track(:second :station :open, neuhei[:alb - 1sw, :alb + 1sw]);
    marker(:de.hp :open :left, neuhei[:alb]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:alb]);
    station(:left :open, neuhei[:alb - 0.4sw] << 1.9sh,
        "Albersdorf", "48,42"
    );

    # Streckengleis Albersdorf - Nordhastedt
    track(:second :open, neuhei[:alb + 1sw, :nha - 1sw]);

    
    #--- point.de.Nordhastedt
    #
    track(:second :station :open, neuhei[:nha - 1sw, :nha + 1sw]);
    marker(:de.hp :open :right, neuhei[:nha]);
    with layer = -1 marker(:de.bf :gone :right, neuhei[:nha]);
    station(:top :open, neuhei[:nha] >> 1.4sw,
        "Nordhastedt", "56,26"
    );

    # Streckengleis Nordhastedt - Heide
    track(:second :open, neuhei[:nha + 1sw, :ff]);
    with layer = 1 line_badge(:open, neuhei[:nha + 2.0km], "1042");
}


with detail = 3 {
    # Streckengleis Neumünster - Wasbek
    track(:second :open, neuhei[:nst - .5ssw, :was - 1ssw]);

    # Neumünster Stadtwald
    marker(:de.hp :open :left, neuhei[:nst]);
    slabel(:left, neuhei[:nst] >> 1dt, "N. Stadtwald");

    # Wasbek
    track(:second :station :open, neuhei[:was - 1ssw, :was + 1ssw]);
    marker(:de.hp :open :left, neuhei[:was]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:was]);
    slabel(:bottom :open, neuhei[:was] << 1.4ssw, "Wasbek");

    # Streckengleis Wasbek - Aukrug
    track(:second :open, neuhei[:was + 1ssw, :auk - 1ssw]);

    # .Bünzenfeld
    #
    marker(:de.ldst :removed :left, neuhei[:bun]);
    slabel(:bottom :removed, neuhei[:bun] << 1.2ssw, "Bünzenfeld");

    # Aukrug
    track(:second :station :open, neuhei[:auk - 1ssw, :auk + 1ssw]);
    marker(:de.hp :open :right, neuhei[:auk]);
    with layer = -1 marker(:de.bf :gone :right, neuhei[:auk]);
    slabel(:top :open, neuhei[:auk] >> 1.4ssw, "Aukrug");

    # Streckengleis Aukrug - Hohenwestedt
    track(:second :open, neuhei[:auk + 1ssw, :hwe - 1ssw]);
    with layer = 1 line_badge(:open, neuhei[:auk + 3.0km], "1042");

    # Hohenwestedt
    track(:second :station :open, neuhei[:hwe - 1ssw, :hwe + 1ssw]);
    marker(:de.bf :open :right, neuhei[:hwe]);
    slabel(:top :open, neuhei[:hwe] >> 1.4ssw +  (2ssw, 0ssw),
        span(:small :bold, "Hohenwestedt")
    );

    # Streckengleis Hohenwestedt - Osterstedt
    track(:second :open, neuhei[:hwe + 1ssw, :ost - 1ssw]);

    # Osterstedt
    track(:second :station :open, neuhei[:ost - 1ssw, :ost + 1ssw]);
    marker(:de.hp :open :right, neuhei[:ost]);
    with layer = -1 marker(:de.bf :gone :right, neuhei[:ost]);
    slabel(:top :open, neuhei[:ost] >> 1.4ssw + (1ssw, 0ssw), "Osterstedt");

    # Streckengleis Osterstedt - Beringstedt
    track(:second :open, neuhei[:ost + 1ssw, :ber - 1ssw]);

    # Beringstedt
    track(:second :station :open, neuhei[:ber - 1ssw, :ber + 1ssw]);
    marker(:de.hp :open :left, neuhei[:ber]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:ber]);
    slabel(:top :open, neuhei[:ber] >> 1dt, "Beringstedt");

    # Streckengleis Beringstedt - Gokels
    track(:second :open, neuhei[:ber + 1ssw, :gok - 1ssw]);

    # Gokels
    track(:second :station :open, neuhei[:gok - 1ssw, :gok + 1ssw]);
    marker(:de.hp :open :left, neuhei[:gok]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:gok]);
    slabel(:bottom :open, neuhei[:gok] << 1.4ssw, "Gokels");

    # Streckengleis Gokels - Hademarschen
    track(:second :open, neuhei[:gok + 1ssw, :had - 1ssw]);

    # Hademarschen
    track(:second :station :open, neuhei[:had - 1ssw, :had + 1ssw]);
    marker(:de.hp :open :right, neuhei[:had]);
    with layer = -1 marker(:de.bf :gone :right, neuhei[:had]);
    slabel(:top :open, neuhei[:had] >> 1.4ssw, "Hademarschen");

    # Streckengleis Hademarschen - Beldorf
    track(:second :open, neuhei[:had + 1ssw, :bel - 1ssw]);

    # Beldorf
    track(:second :station :open, neuhei[:bel - 1ssw, :bel + 1ssw]);
    marker(:de.hp :open :left, neuhei[:bel]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:bel]);
    slabel(:bottom :open, neuhei[:bel] << 1.4ssw, "Beldorf");

    # Streckengleis Beldorf - Albersdorf
    track(:second :open, neuhei[:bel + 1ssw, :alb - 1ssw]);

    # Beldorf Dkst
    marker(:de.dkst :closed :right, neuhei[:bed]);

    # Albersdorf
    track(:second :station :open, neuhei[:alb - 1ssw, :alb + 1ssw]);
    marker(:de.hp :open :left, neuhei[:alb]);
    with layer = -1 marker(:de.bf :gone :left, neuhei[:alb]);
    slabel(:left :open, neuhei[:alb - 0.4ssw] << 2.4ssw, "Albersdorf");

    # Streckengleis Albersdorf - Nordhastedt
    track(:second :open, neuhei[:alb + 1ssw, :nha - 1ssw]);
    with layer = 1 line_badge(:open, neuhei[:alb + 4.0km], "1042");
    
    # Nordhastedt
    track(:second :station :open, neuhei[:nha - 1ssw, :nha + 1ssw]);
    marker(:de.hp :open :right, neuhei[:nha]);
    with layer = -1 marker(:de.bf :gone :right, neuhei[:nha]);
    slabel(:top :open, neuhei[:nha] >> 1.4ssw + (2ssw, 0ssw), "Nordhastedt");

    # Streckengleis Nordhastedt - Heide
    track(:second :open, neuhei[:nha + 1ssw, :ff]);
}


with detail = 2 {
    track(:second :open,
            altkie[:ahei - 0.1dl, :ahei]
        ..  neuhei[:aa, :ff]
    );
}
