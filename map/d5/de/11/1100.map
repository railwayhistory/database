# DE 1100.  Lübeck Hbf (ausschl.) - Puttgarden
#
let burort = path("path.de.1103");
let lubput = path("path.de.1100");
let waltra = path("path.de.1113");

with detail = 5 {
    with link = "line.de.1100" {
        track(:first :double, lubput[:aluh, :wal - 0.5sw]);
        with layer = 1 badge(lubput[:wal - 1.4km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11001)")
            )
        );
    }

    with link = "point.de.Schwartau-Waldhalle-Wr" {
        track(:first :station :double, lubput[:wal - 0.5sw, :wal + 0.5sw]);
        track(:first :station :double,
                lubput[:wal, :wal + 0.1dl]
            ..  waltra[:aa - 0.1dl, :aa]
        );

        marker(:de.abzw :left, lubput[:wal] << 0.5dt);
        station(:left, lubput[:wal - 0.4sw] << 0.5dt << 1.4sw,
            hbox(:center:base :bold,
                span(:open, "Schwartau Waldhalle "),
                span(:removed, "(Wr)")
            ),
            hbox(:center:top,
                vbox(:right:top,
                    span(:open, "1100: "),
                    span(:removed, "1110: "),
                    span(:open, "1113: ")
                ),
                vbox(:right:top,
                    span(:open, "4,"),
                    span(:removed, ""),
                    span(:open, "4,")
                ),
                vbox(:left:top,
                    span(:open, "70 "),
                    span(:removed, ""),
                    span(:open, "70 ")
                ),
                vbox(:right:top,
                    span(:removed, "← "),
                    span(:removed, ""),
                    span(:removed, "← ")
                ),
                vbox(:right:top,
                    span(:removed, "4,"),
                    span(:removed, "28,"),
                    span(:removed, "4,")
                ),
                vbox(:left:top,
                    span(:removed, "89"),
                    span(:removed, "04"),
                    span(:removed, "88")
                )
            )
        );
    }

    with link = "line.de.1100" {
        track(:first :double, lubput[:wal + 0.5sw, :swr.sf - 60m]);
    }


    with link = "point.de.Bad-Schwartau" {
        # XXX TODO
        track(:first :double, lubput[:swr.sf - 60m, :swr.sn - 60m]);

        marker(:de.hp :left, lubput[:swr] << 0.5dt);
        with layer = -1 marker(:de.bf :gone :left, lubput[:swr] << 0.5dt);
        station(:left, lubput[:swr - 0.5sw] << 0.5dt << 1.3sw,
            span(:bold, "Bad Schwartau"),
            hbox(:center:top,
                vbox(:right:top,
                    span(:open, "1100: "),
                    span(:removed, "11001: "),
                    span(:closed, "1110: ")
                ),
                vbox(:right:top,
                    span(:open, "6,"),
                    span(:removed, "0,"),
                    span(:closed, "26,")
                ),
                vbox(:left:top,
                    span(:open, "00"),
                    span(:removed, "00"),
                    span(:closed, "93")
                )
            )
        );

        marker(:de.stw :closed :left, lubput[:swr.sf] << 0.5dt);
        slabel(:left :closed, lubput[:swr.sf - 2pt] << 3.0dt, "Sf");
    }

    with link = "point.de.Bad-Schwartau-Abzw" {
        track(:first :double, lubput[:swr.sn - 60m, :swr.sn + 450m]);
        
        # W31 - W32
        track(:station,
                lubput[:swr.sn +  14m, :swr.sn +  15m] << 0.5dt
            ..  lubput[:swr.sn + 150m, :swr.sn + 151m] >> 0.5dt
        );
        # W33 - W34
        track(:station,
                lubput[:swr.sn + 239m, :swr.sn + 240m] >> 0.5dt
            ..  lubput[:swr.sn + 385m, :swr.sn + 386m] << 0.5dt
        );

        marker(:de.abzw :left, lubput[:swa] << 0.5dt);
        label(lubput[:swa - 0.8sw] << 0.5dt << 1.8sw,
            hbox(:right:bottom,
                vbox(:center:bottom,
                    hbox(:center:top :xsmall,
                        vbox(:right:top,
                            span(:open, "1100: "),
                            span(:open, "1110: ")
                        ),
                        vbox(:right:top,
                            span(:open, "6,"),
                            span(:open, "26,")
                        ),
                        vbox(:left:top,
                            span(:open, "44"),
                            span(:open, "51")
                        )
                    ),
                    span(:medium :bold, "Bad Schwartau Abzw")
                )
            )
        );

        marker(:de.stw :closed :left, lubput[:swa] << 0.5dt << 1sw);
        slabel(:right :closed, lubput[:swa - 2pt] >> 2.5dt, "Sn");
    }


    with link = "line.de.1100" {
        track(:first,
                lubput[:swr.sn + 450m, :aeut.ff - 1km] >> 0.5dt
            ..  lubput[:aeut.ff, :rat.a]
        );
        with layer = 1 badge(lubput[:swa + 1.9km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11001)")
            )
        );
    }


    with link = "point.de.Ratekau" {
        # Gl. 2 (Hauptgleis)
        track(:first, lubput[:rat.a, :rat.f]);

        # Gl. 1 (>> 1dt)
        track(:station,
                lubput[:rat.a +  59m, :rat.a + 60m]
            ..  lubput[:rat.a + 200m, :rat.f - 200m] >> 1dt
            ..  lubput[:rat.f -  60m, :rat.f - 59m]
        );

        marker(:de.bbf :left, lubput[:rat]);
        with layer = -1 marker(:de.bf :gone :left, lubput[:rat]);
        station(:left, lubput[:rat - 0.5sw] << 1.4sw,
            "Ratekau",
            hbox(:center:base,
                span(:regular, "10,59 "),
                span(:removed, "(4,60)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:rat.f, :tim.f]);
        with layer = 1 badge(lubput[:rat + 2.2km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11001)")
            )
        );
    }


    with link = "point.de.Timmendorferstrand" {
        # Gl. 1 (>> 1dt)
        track(:station,
                lubput[:tim.a +  59m, :tim.a + 60m]
            ..  lubput[:tim.a + 180m, :tim.f - 180m] >> 1dt
            ..  lubput[:tim.f -  60m, :tim.f -  59m]
        );

        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:tim.a, :tim.f]);

        # Gl. 3 (<< 1dt, Norseite unklar)
        with layer = -1 track(:station :closed,
                lubput[:tim.a + 109m, :tim.a + 110m]
            ..  lubput[:tim.a + 200m, :tim   + 150m] << 1dt
        );

        marker(:de.bf :right, lubput[:tim] >> 1dt);
        station(:right :open, lubput[:tim - 0.35sw] >> 1dt >> 1.4sh,
            "Timmendorfer Strand",
            hbox(:center:base,
                span(:regular, "15,77 "),
                span(:removed, "(9,77)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:tim.f, :sar.a]);
        with layer = 1 badge(lubput[:tim + 1.5km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11001)")
            )
        );
    }


    with link = "point.de.Scharbeutz" {
        # Gl.1 (>> 1dt)
        track(:station,
                lubput[:sar.a +  59m, :sar.a +  60m]
            ..  lubput[:sar.a + 260m, :sar.f - 210m] >> 1dt
            ..  lubput[:sar.f -  60m, :sar.f -  59m]
        );
        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:sar.a, :sar.f]);

        marker(:de.bf :right, lubput[:sar] >> 1dt);
        station(:right, lubput[:sar - 0.4sw] >> 1dt >> 1.4sh,
            "Scharbeutz",
            hbox(:center:base,
                span(:regular, "18,70 "),
                span(:removed, "(12,71)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:sar.f, :haf.a]);
        with layer = 1 badge(lubput[:sar + 2.1km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11001)")
            )
        );
    }


    with link = "point.de.Haffkrug" {
        # Gl. 1 (>> 1dt)
        track(:station,
                lubput[:haf.a +  59m, :haf.a +  60m]
            ..  lubput[:haf.a + 180m, :haf.f - 180m] >> 1dt
            ..  lubput[:haf.f -  60m, :haf.f -  59m]
        );
        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:haf.a, :haf.f]);

        marker(:de.bf :right, lubput[:haf] >> 1dt);
        station(:right, lubput[:haf - 0.3sw] >> 1dt >> 1.7sh,
            "Haffkrug",
            hbox(:center:base,
                span(:regular, "23,04 "),
                span(:removed, "(17,07)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:haf.f, :sie.a]);
        with layer = 1 badge(lubput[:haf + 1.3km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11001)")
            )
        );
    }


    with link = "point.de.Sierksdorf" {
        # Gl. 1 (<< 1dt)
        track(:station,
                lubput[:sie.w1 - 1m, :sie.w1]
            ..  lubput[:sie.w1 + 120m, :sie.f - 180m] << 1dt
            ..  lubput[:sie.f - 60m, :sie.f - 59m]
        );
        # Gl. 2
        track(:first :station, lubput[:sie.a, :sie.f]);

        marker(:de.bf :right, lubput[:sie]);
        station(:right, lubput[:sie - 0.4sw] >> 2.1sh,
            "Sierksdorf",
            hbox(:center:base,
                span(:regular, "25,40 "),
                span(:removed, "(19,39)")
            )
        );
        with layer = -1 marker(:de.bft :left :closed, lubput[:sib] << 1dt);
        station(:left :closed, lubput[:sib - 0.4sw] << 1dt << 1.2sh,
            "Sierksdorf", "26,16"
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:sie.f, :neg.a]);
        with layer = 1 badge(lubput[:sib + 1.3km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11001)")
            )
        );
    }

    # point.de.Neustadt-Holst-Gbf: 1023.

    with link = "line.de.1100" {
        track(:first, lubput[:neg.f, :ssl - 0.5sw]);
    }


    with link = "point.de.Südschleuse" {
        track(:first :station, lubput[:ssl - 0.5sw, :ssl + 0.5sw]);
        with layer = -1 marker(:de.abzw :removed :left, lubput[:ssl]);
        station(:left :removed, lubput[:ssl - 0.4sw] << 1.4sh,
            "Südschleuse", "??"
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:ssl + 0.5sw, :has.a]);
        with layer = 1 badge(lubput[:has - 2.65km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }


    with link = "point.de.Hasselburg" {
        # Gl. 1 (<< 1dt)
        track(:station,
                lubput[:has.a +  59m, :has.a +  60m]
            ..  lubput[:has.a + 160m, :has.f - 160m] << 1dt
            ..  lubput[:has.f -  60m, :has.f -  59m]
        );
        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:has.a, :has.f]);

        marker(:de.bbf :right, lubput[:has]);
        station(:right, lubput[:has - 0.3sw] >> 1.7sh,
            "Hasselburg",
            hbox(:center:base,
                span(:regular, "34,47 "),
                span(:removed, "(5,31)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:has.f, :gsl.a]);
        with layer = 1 badge(lubput[:has + 2.0km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }


    with link = "point.de.Groß-Schlamin" {
        # Gl. 1 (>> 1dt)
        track(:station,
                lubput[:gsl.a +  59m, :gsl.a +  60m]
            ..  lubput[:gsl.a + 180m, :gsl.r -  25m] >> 1dt
        );
        with layer = -1 track(:station :removed,
                lubput[:gsl.r -  25m, :gsl.r +  25m] >> 1dt
        );
        track(:station :closed,
                lubput[:gsl.r +  25m, :gsl.f - 230m] >> 1dt
        );
        with layer = -1 track(:station :removed,
                lubput[:gsl.f - 230m, :gsl.f - 181m] >> 1dt
        );
        track(:station,
                lubput[:gsl.f - 181m, :gsl.f - 180m] >> 1dt
            ..  lubput[:gsl.f -  60m, :gsl.f -  59m]
        );

        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:gsl.a, :gsl.f]);

        marker(:de.bbf :left, lubput[:gsl]);
        station(:left, lubput[:gsl - 0.5sw] << 1.3sw,
            "Groß Schlamin",
            hbox(:center:base,
                span(:regular, "38,37 "),
                span(:removed, "(8,21)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:gsl.f, :bes.a]);
        with layer = 1 badge(lubput[:gsl + 1.6km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }


    with link = "point.de.Beschendorf" {
        # Gl. 1 (<< 1dt)
        track(:station,
                lubput[:bes.a +  59m, :bes.a +  60m]
            ..  lubput[:bes.a + 160m, :bes.f - 180m] << 1dt
            ..  lubput[:bes.f -  60m, :bes.f -  59m]
        );
        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:bes.a, :bes.f]);

        marker(:de.bbf :left, lubput[:bes] << 1dt);
        station(:left, lubput[:bes - 0.4sw] << 1dt << 1.4sw,
            "Beschendorf",
            hbox(:center:base,
                span(:regular, "41,68 "),
                span(:removed, "(11,31)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:bes.f, :len.a]);
        with layer = 1 badge(lubput[:bes + 1.7km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }


    with link = "point.de.Lensahn" {
        # Gl. 1 (<< 1dt)
        with layer = -1 track(:station :closed,
                lubput[:len.a +  59m, :len.a +  60m]
            ..  lubput[:len.a + 160m, :len.f - 440m] << 1dt
        );
        track(:station,
                lubput[:len.f - 440m, :len.f - 140m] << 1dt
        );
            # W17 - W19
            track(:station,
                    lubput[:len.f - 181m, :len.f - 180m] << 1dt
                ..  lubput[:len.f - 120m, :len.f - 119m]
            );

        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:len.a, :len.f]);

        # Gl. 3? (>> 1dt)
        with layer = -1 track(:station :closed,
                lubput[:len.a + 149m, :len.a + 150m]
            ..  lubput[:len.a + 200m, :len.f - 160m] >> 1dt
            ..  lubput[:len.f -  60m, :len.f -  59m]
        );
        # Anschlußgleis Nordkopf
        with layer = -1 track(:station :removed,
                lubput[:len.f - 191m, :len.f - 190m] >> 1dt
            ..  lubput[:len.f -  90m, :len.f] >> 3dt
        );

        marker(:de.bf :left, lubput[:len] << 1dt);
        station(:left :right_align, lubput[:len - 0.4sw] << 1dt << 1.4sw,
            "Lensahn",
            hbox(:center:base,
                span(:regular, "44,96 "),
                span(:removed, "(15,80)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:len.f, :gru.a]);
    }


    with link = "point.de.Grüner-Hirsch" {
        # Gl. 1 (<< 1dt)
        track(:station,
                lubput[:gru.a +  59m, :gru.a +  60m]
            ..  lubput[:gru.a + 160m, :gru.f - 180m] << 1dt
            ..  lubput[:gru.f -  60m, :gru.f -  59m]
        );

        # Gl. 2 (<< 2dt)
        track(:first :station, lubput[:gru.a, :gru.f]);

        marker(:de.bbf :left, lubput[:gru] << 1dt);
        station(:left, lubput[:gru - 0.4sw] << 1dt << 1.4sw,
            "Grüner Hirsch",
            hbox(:center:base,
                span(:regular, "47,10 "),
                span(:removed, "(17,94)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:gru.f, :old.a]);
        with layer = 1 badge(lubput[:gru + 2.5km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }

    
    with link = "point.de.Oldenburg-Holst-Gbf" {
        # Gl. 6 (Hauptgleis)
        track(:first :station, lubput[:old.a, :old.r]);

        # Gl. 7 (>> 1dt)
        track(:station,
                lubput[:old.a +  59m, :old.a + 60m]
            ..  lubput[:old.a + 180m, :old.r] >> 1dt
        );
            # W7 - W8
            track(:station,
                    lubput[:old.r - 71m, :old.r - 70m] >> 1dt
                ..  lubput[:old.r -  1m, :old.r]
            );

        # Gl. 8? (>> 2dt)
        track(:station,
                lubput[:old.a + 269m, :old.a + 270m] >> 1dt
            ..  lubput[:old.a + 340m, :old.a + 345m] >> 2dt
        );
        with layer = -1 track(:station :closed,
                lubput[:old.a + 345m, :old.r - 165m] >> 2dt
        );
        track(:station,
                lubput[:old.r - 165m, :old.r - 160m] >> 2dt
            ..  lubput[:old.r - 70m, :old.r - 69m] >> 1dt
        );

        marker(:de.bft :left, lubput[:olg]);
        station(:left, lubput[:olg - 0.2sw] << 1.6sw,
            hbox(:center:base,
                span(:regular, "Oldenburg "),
                span(:light, "(Holst) "),
                span(:regular, "Gbf")
            ),
            "??"
        );
    }

    with link = "point.de.Oldenburg-Holst" {
        # Gl. 1 (<< 1dt)
        track(:station,
                lubput[:old.r -   1m, :old.r]
            ..  lubput[:old.r +  80m, :old.r +  81m] << 1dt
        );
        with layer = -1 track(:station :removed,
                lubput[:old.r +  80m, :old.f - 140m] << 1dt
            ..  lubput[:old.f -  60m, :old.f -  59m]
        );

        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:old.r, :old.f]);

        # Gl. >> 1dt
        with layer = -1 track(:station :removed,
                lubput[:old.r, :old.f - 140m] >> 1dt
        );

        # Gl. >> 2dt
        track(:station,
                lubput[:old.r -   1m, :old.r] >> 1dt
            ..  lubput[:old.r + 100m, :old.r + 200m] >> 2dt
        );

        # GL. >> 3dt
        track(:station,
                lubput[:old.r -   1m, :old.r] >> 1dt
            ..  lubput[:old.r + 120m, :old.f - 140m] >> 3dt
        );
        with layer = -1 track(:station :closed,
                lubput[:old.r +  60m, :old.r + 120m] >> 3dt
        );

        marker(:de.bf :left, lubput[:old] << 1dt);
        station(:left, lubput[:old - 0.3sw] << 1.6sw,
            hbox(:center:base,
                span(:regular, "Oldenburg "),
                span(:light, "(Holst) ")
            ),
            hbox(:center:base,
                span(:regular, "52,27 "),
                span(:removed, "(23,13)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:old.f, :ols - 1sw]);
    }


    with link = "point.de.Oldenburg-Holst-Stadt" {
        track(:first :statin, lubput[:ols - 1sw, :ols + 1sw]);
        with layer = -1 marker(:de.anst :removed :left, lubput[:ols]);
        with layer = -2 marker(:de.hp :gone :left, lubput[:ols]);
        station(:top :removed, lubput[:ols] << 1.4sh,
            hbox(:center:base,
                span(:regular, "Oldenburg "),
                span(:light, "(Holst) "),
                span(:regular, "Stadt")
            ),
            hbox(:center:base,
                span(:regular, "?? "),
                span(:removed, "(24,05)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:ols + 1sw, :goh.a]);
        with layer = 1 badge(lubput[:ols + 1.7km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }


    with link = "point.de.Göhl" {
        # Gl. 1 (>> 1dt)
        track(:station,
                lubput[:goh.a +  59m, :goh.a +  60m]
            ..  lubput[:goh.a + 240m, :goh.a + 250m] >> 2dt
            ..  lubput[:goh  - 0.5sw, :goh.f - 180m] >> 1dt
            ..  lubput[:goh.f -  60m, :goh.f -  59m]
        );

        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:goh.a, :goh.f]);

        marker(:de.bbf :right, lubput[:goh] >> 1dt);
        station(:bottom, lubput[:goh] >> 1dt >> 1.4sh,
            "Göhl",
            hbox(:center:base,
                span(:regular, "56,60 "),
                span(:removed, "(27,46)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:goh.f, :her - 1sw]);
        with layer = 1 badge(lubput[:goh + 2.5km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }


    with link = "point.de.Heringsdorf-Holst" {
        track(:first :station, lubput[:her - 1sw, :her + 1sw]);
        with layer = -1 marker(:de.bf :closed :right, lubput[:her]);
        station(:right :closed, lubput[:her - 0.4sw] >> 1.8sw,
            hbox(:center:base,
                span(:regular, "Heringsdorf "),
                span(:light, "(Holst)")
            ),
            hbox(:center:base,
                span(:regular, "61,42 "),
                span(:removed, "(32,30)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:her + 1sw, :nki.a]);
        with layer = 1 badge(lubput[:her + 1.2km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }


    with link = "point.de.Neukirchen-Holst" {
        # Gl. 1 (<< 1dt)
        track(:station,
                lubput[:nki.a +  59m, :nki.a + 60m]
            ..  lubput[:nki.a + 140m, :nki.f - 90m] << 1dt
        );
            # W3 - W4
            track(:station,
                    lubput[:nki.f - 151m, :nki.f - 150m] << 1dt
                ..  lubput[:nki.f -  60m, :nki.f -  59m]
            );

        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:nki.a, :nki.f]);

        marker(:de.bbf :left, lubput[:nki] << 1dt);
        station(:left, lubput[:nki - 0.3sw] << 1.6sh,
            hbox(:center:base,
                span(:regular, "Neukirchen "),
                span(:light, "(Holst)")
            ),
            hbox(:center:base,
                span(:regular, "64,35 "),
                span(:removed, "(35,24)")
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:nki.f, :lus - 0.5sw]);
        with layer = 1 badge(lubput[:nki + 1.7km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11011)")
            )
        );
    }


    with link = "point.de.Lütjenbrode-Süd" {
        track(:first :station, lubput[:lus - 0.5sw, :lus + 0.5sw]);
        with layer = -1 marker(:de.abzw :removed :right, lubput[:lus]);
        station(:right :removed, lubput[:lus - 0.4sw] >> 1.4sh,
            "Lütjenbrode Süd",
            hbox(:center:base,
                vbox(:right:top,
                    span(:regular, "1100: "),
                    span(:regular, "11011: ")
                ),
                vbox(:right:top,
                    span(:regular, "??"),
                    span(:regular, "??")
                )
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:lus + 0.5sw, :luo - 0.5sw]);
        with layer = 1 line_badge(:open, lubput[:lus + 0.7km], "1100");
    }


    with link = "point.de.Lütjenbrode-Ost" {
        track(:first :station, lubput[:luo - 0.5sw, :luo + 0.5sw]);
        with layer = -1 marker(:de.anst :removed :left, lubput[:luo]);
        with layer = -2 marker(:de.abzw :gone :left, lubput[:luo]);
        station(:top :removed, lubput[:luo] << 1.4sh,
            "Lütjenbrode Ost",
            hbox(:center:base,
                vbox(:right:top,
                    span(:regular, "1100: "),
                    span(:regular, "11021: ")
                ),
                vbox(:right:top,
                    span(:regular, "??"),
                    span(:regular, "??")
                )
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:luo + 0.5sw, :gbr.a]);
        with layer = 1 badge(lubput[:luo + 0.65km],
            hbox(:center:middle,
                span(:small, "1100 "),
                span(:small:removed, "(11021)")
            )
        );
    }


    with link = "point.de.Großenbrode" {
        # Gl. 1 - Gl. 7 (<< 1dt)
        track(:station,
                lubput[:gbr.a +  59m, :gbr.a +  60m]
            ..  lubput[:gbr.a + 150m, :gbr.f - 150m] << 1dt
            ..  lubput[:gbr.f -  60m, :gbr.f -  59m]
        );
            # W10 - W11
            track(:station,
                    lubput[:gbr.w10 - 1m, :gbr.w10] << 1dt
                ..  lubput[:gbr.w10 + 80m, :gbr.w10 + 81m]
            );

        # Gl. 2 - Gl. 8 (Hauptgleis)
        track(:first :station, lubput[:gbr.a, :gbr.f]);

        # Gl. 3? (>> 1dt
        track(:station :closed, lubput[:gbr.a + 400m, :gbr.w10 + 50m] >> 1dt);
            # Von Gl. 4? vor W10
            track(:station :closed,
                    lubput[:gbr.w10 - 131m, :gbr.w10 - 130m] >> 2dt
                ..  lubput[:gbr.w10 -  70m, :gbr.w10 -  69m] >> 1dt
            );
            # Nach Gl. 2 vor W10
            track(:station :closed,
                    lubput[:gbr.w10 - 61m, :gbr.w10 - 60m] >> 1dt
                ..  lubput[:gbr.w10, :gbr.w10 + 1m]
            );

        marker(:de.bf :left, lubput[:gbr] << 1dt);
        station(:left, lubput[:gbr - 0.4sw] << 1dt << 1.4sw,
            span(:bold, "Großenbrode"),
            hbox(:center:base,
                vbox(:right:top,
                    span(:regular, "1100: "),
                    span(:removed, "11021: ")
                ),
                vbox(:right:top,
                    span(:regular, "70,"),
                    span(:removed, "3,")
                ),
                vbox(:left:top,
                    span(:regular, "49"),
                    span(:removed, "04")
                )
            )
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:gbr.f, :bfea]);
        with layer = 1 line_badge(:open, lubput[:gbr + 2.5km], "1100");
    }


    with link = "struct.de.Fehmarnsundbrücke" {
        track(:first, lubput[:bfea, :bfef]);
        slabel(:right, lubput[:bfea + 450m] >> 2dt, "Fehmarnsundbrücke");
    }


    with link = "line.de.1100" {
        track(:first, lubput[:bfef, :str.a]);
        with layer = 1 line_badge(:open, lubput[:str - 1.5km], "1100");
    }


    with link = "point.de.Strukkamp" {
        # Gl. 1 (<< 1dt)
        track(:station,
                lubput[:str.a +  59m, :str.a +  60m]
            ..  lubput[:str.a + 150m, :str.f - 150m] << 1dt
            ..  lubput[:str.f -  60m, :str.f -  59m]
        );

        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:str.a, :str.f]);

        marker(:de.bbf :left, lubput[:str] << 1dt);
        station(:left, lubput[:str - 0.4sw] << 1dt << 1.3sh,
            "Strukkamp", "77,82"
        );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:str.f, :buw.a]);
        with layer = 1 line_badge(:open, lubput[:str + 2.0km], "1100");
    }


    with link = "point.de.Burg-Fehmarn-West" {
        # Gl. 1 (>> 1dt)
        track(:second :station,
                lubput[:buw.a + 59m, :buw.a + 60m]
            ..  lubput[:buw.a + 120m, :buw.a + 200m] >> 1dt
            ..  burort[:bua + 1m, :bua]
        );
        track(:station,
                lubput[:buw.a + 200m, :buw.f - 180m] >> 1dt
        );
        track(:second :station,
                burort[:bua, :bua + 1m]
            ..  lubput[:buw.f - 180m, :buw.f - 160m] >> 1dt
            ..  lubput[:buw.f -  60m, :buw.f -  59m]
        );

        # Gl. 2 (Hauptgleis)
        track(:first :station, lubput[:buw.a, :buw.f]);

        # Abzw aus Richtung Orth
        with layer = -1 track(:second :station :closed,
                burort[:buw.ff, :buw.ff - 1m]
            ..  lubput[:buw.a + 140m, :buw.a + 141m]
        );

        marker(:de.bbf :right, lubput[:buw] >> 1dt);
        station(:left, lubput[:buw - 0.4sw] << 3dt,
            hbox(:right:base,
                span(:regular, "Burg "),
                span(:light, "(Fehmarn) "),
                span(:regular, "West")
            ),
            hbox(:center:top,
                vbox(:right:top,
                    span(:open, "1100: "),
                    span(:open, "1103: "),
                    span(:open, "1104: ")
                ),
                vbox(:right:top,
                    span(:open, "82,"),
                    span(:open, ""),
                    span(:open, "0,")
                ),
                vbox(:left:top,
                    span(:open, "15"),
                    span(:open, "??"),
                    span(:open, "37")
                )
             )
         );
    }


    with link = "line.de.1100" {
        track(:first, lubput[:buw.f, :put.a]);
        with layer = 1 line_badge(:open, lubput[:buw + 2.5km], "1100");
    }

    with link = "point.de.Puttgarden" {
        let putput = path("path.de.1100.put");

        # XXX TODO

        # Gl. 3
        track(:station,
                putput[:put.pf + 9m, :put.pf + 10m] << 6dt
            ..  putput[:put.pf + 190m, :put + 60m] << 8dt
        );
        with layer = -1 track(:station :removed,
                putput[:put + 60m, :put + 61m] << 8dt
            ..  putput[:f - 20m, :f] << 5dt
        );

        # Gl. 5
        track(:first :station, putput[:put.pf, :put + 60m] << 6dt);

        # Gl. 6
        track(:first :station, lubput[:put.pf, :put + 60m] << 5dt);

        # Gl. 50
        track(:first :station,
                lubput[:put.a + 59m, :put.a + 60m]
            ..  lubput[:put.a + 380m, :put.r] << 2dt
            ..  lubput[:put.r + 500m, :put.pf - 340m] << 18dt
            ..  lubput[:put.pf - 10m, :put.pf] << 6dt
        );

        # Gl. 69
        track(:station,
                lubput[:put.a + 380m, :put.r] << 1dt
        );
            # W2 - W3
            track(:station,
                    lubput[:put.r - 1m, :put.r] << 1dt
                ..  lubput[:put.r + 70m, :put.r + 71m]
            );

        # Gl. 70
        track(:first :station,
                lubput[:put.a, :put.pf - 360m]
            ..  lubput[:put.pf - 100m, :put.pf] << 5dt
        );
            # W4 - W5
            with layer = -1 track(:station :closed,
                    lubput[:put.r + 119m, :put.r + 120m]
                ..  lubput[:put.r + 190m, :put.r + 191m] >> 1dt
            );

        # Gl. 71
        track(:station :closed, lubput[:put.r - 160m, :put.r + 200m] >> 1dt);

        with layer = -1 marker(:de.bft :closed :left, lubput[:pus] << 18dt);
        station(:left :closed, lubput[:pus - 0.4sw] << 18dt << 1.4sh,
            "Puttgarden (Ps)", "??"
        );

        marker(:de.bf :left, putput[:put] << 13dt);
        station(:left, putput[:put - 0.4sw] << 13dt << 1.4sh,
            span(:bold, "Puttgarden"),
            "1100: 88,59"
        );
    }
}

